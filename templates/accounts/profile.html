{% extends 'base.html' %}
{% load static %}

{% block title %}Мой профиль{% endblock %}

{% block content %}
<div class="container">
    <div class="profile-page">
        <h1 class="page-title">Мой профиль</h1>

        <div class="profile-grid">
            <!-- Profile Info -->
            <div class="profile-card">
                <h2>Личные данные</h2>

                <form method="post" class="profile-form">
                    {% csrf_token %}

                    <div class="form-group">
                        <label>Телефон</label>
                        <input type="text" value="{{ user.phone }}" disabled class="form-input">
                        <small>Телефон изменить нельзя</small>
                    </div>

                    <div class="form-group">
                        <label for="{{ form.first_name.id_for_label }}">{{ form.first_name.label }}</label>
                        {{ form.first_name }}
                    </div>

                    <div class="form-group">
                        <label for="{{ form.last_name.id_for_label }}">{{ form.last_name.label }}</label>
                        {{ form.last_name }}
                    </div>

                    <div class="form-group">
                        <label for="{{ form.email.id_for_label }}">{{ form.email.label }}</label>
                        {{ form.email }}
                    </div>

                    <button type="submit" class="btn btn-primary">
                        Сохранить
                    </button>
                </form>
            </div>

            <!-- Bonus Balance -->
            <div class="profile-card bonus-card">
                <h2>Бонусный баланс</h2>
                <div class="bonus-amount">{{ user.bonus_balance }} <span>бонусов</span></div>
                <p class="bonus-info">1 бонус = 1 сум</p>
            </div>
        </div>

        <!-- Recent Orders -->
        <div class="profile-section">
            <div class="section-header">
                <h2>Последние заказы</h2>
                <a href="{% url 'orders:history' %}" class="link">Все заказы</a>
            </div>

            {% if orders %}
            <div class="orders-list">
                {% for order in orders %}
                <div class="order-card">
                    <div class="order-header">
                        <span class="order-number">Заказ #{{ order.pk }}</span>
                        <span class="order-status status-{{ order.status }}">{{ order.get_status_display }}</span>
                    </div>
                    <div class="order-info">
                        <span class="order-date">{{ order.created_at|date:"d.m.Y H:i" }}</span>
                        <span class="order-total">{{ order.total|floatformat:0 }} сум</span>
                    </div>
                    <a href="{{ order.get_absolute_url }}" class="order-link">Подробнее</a>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="no-orders">У вас пока нет заказов</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
